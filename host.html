<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Welcome to the Show!</title>
  <link href="https://fonts.googleapis.com/css2?family=Changa+One&family=Archivo+Black&family=Figtree:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
  <style>
    body, html {
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }
    .host-bg {
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      z-index: 0;
      filter: brightness(1.08) saturate(1.2);
      animation: fadein-bg 1.8s cubic-bezier(.7,.2,.3,1);
    }
    @keyframes fadein-bg {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    .disco-ball {
      position: absolute;
      top: 4vh;
      left: 50%;
      transform: translateX(-50%);
      width: 64px;
      height: 64px;
      z-index: 2;
      background: radial-gradient(circle at 60% 40%, #fff 60%, #e6e6e6 100%);
      border-radius: 50%;
      box-shadow: 0 0 32px 8px #fff8, 0 0 0 2px #e6e6e6;
      overflow: hidden;
      animation: disco-spin 6s linear infinite;
    }
    @keyframes disco-spin {
      0% { filter: brightness(1) drop-shadow(0 0 8px #fff8); }
      50% { filter: brightness(1.2) drop-shadow(0 0 16px #fff); }
      100% { filter: brightness(1) drop-shadow(0 0 8px #fff8); }
    }
    .disco-ball::after {
      content: "";
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(135deg, #fff 0 2px, #e6e6e6 2px 8px);
      opacity: 0.18;
      border-radius: 50%;
    }
    .host-overlay {
      position: absolute;
      left: 0;
      bottom: 0;
      width: 30vw;
      max-width: 400px;
      z-index: 1;
      pointer-events: none;
    }
    /* During reality check, lift host above overlay so they remain visible */
    .host-on-top {
      z-index: 7;
      filter: none;
      left: -8vw;
      transition: left 0.6s ease;
    }
    .host-img {
      width: 100%;
      height: auto;
      display: block;
      pointer-events: none;
    }
    .text-container {
      position: absolute;
      bottom: 10vh;
      left: 50%;
      transform: translateX(-50%);
      z-index: 3;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.8rem;
      pointer-events: none;
    }
    .host-intro {
      font-family: 'Changa One', 'Archivo Black', Impact, sans-serif;
      font-size: clamp(1.2rem, 2.5vw, 2rem);
      color: #fffbe8;
      background: rgba(62, 28, 23, 0.9);
      border-radius: 12px;
      padding: 1rem 2rem;
      box-shadow: 0 6px 32px rgba(0,0,0,.45);
      text-align: center;
      letter-spacing: 1px;
      border: 3px solid #f9e3c7;
      pointer-events: auto;
      animation: fadein-text 2.2s cubic-bezier(.7,.2,.3,1);
    }
    @keyframes fadein-text {
      from { opacity: 0; transform: translateY(24px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .host-quote {
      font-family: 'Figtree', system-ui, sans-serif;
      font-size: clamp(0.9rem, 1.8vw, 1.4rem);
      color: #ffe6b0;
      background: rgba(62, 28, 23, 0.85);
      border-radius: 10px;
      padding: 0.9rem 1.8rem;
      box-shadow: 0 4px 24px rgba(0,0,0,.3);
      text-align: center;
      border: 2px solid #f9e3c7;
      max-width: 550px;
      pointer-events: auto;
      animation: fadein-text 2.8s cubic-bezier(.7,.2,.3,1);
    }
    .host-quote:empty {
      display: none;
    }
    .click-indicator {
      position: fixed;
      inset: 0;
      z-index: 4;
      cursor: pointer;
      pointer-events: auto;
    }
    .click-indicator::after {
      content: attr(data-text);
      position: absolute;
      left: 50%;
      bottom: 3vh;
      transform: translateX(-50%);
      font-family: 'Changa One', 'Archivo Black', Impact, sans-serif;
      font-size: clamp(1rem, 2vw, 1.5rem);
      color: #fff;
      background: rgba(255, 100, 50, 0.9);
      padding: 0.8rem 2rem;
      border-radius: 50px;
      border: 3px solid #fff;
      box-shadow: 0 4px 20px rgba(255, 100, 50, 0.6);
      animation: pulse 2s ease-in-out infinite;
      pointer-events: none; /* clicks go to the full-screen indicator */
    }
    @keyframes pulse {
      0%, 100% { transform: translateX(-50%) scale(1); opacity: 1; }
      50% { transform: translateX(-50%) scale(1.05); opacity: 0.9; }
    }
    .screen-link {
      position: fixed;
      inset: 0;
      z-index: 2;
      cursor: pointer;
    }
    .hidden {
      display: none;
    }
    .fade-out {
      animation: fadeOut 1s ease-out forwards;
    }
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
    .dimmed {
      filter: brightness(0.4) saturate(0.8) !important;
      transition: filter 1s ease;
    }
    /* Reality check overlay */
    .reality-overlay {
      position: fixed;
      inset: 0;
      z-index: 6;
      display: none;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(2px);
    }
    .reality-card {
      width: min(900px, 92vw);
      max-height: 85vh;
      overflow: auto;
      border-radius: 24px;
      padding: 24px 28px;
      box-shadow: 0 20px 80px rgba(0,0,0,.6);
      background: linear-gradient(180deg, rgba(38,18,14,0.95) 0%, rgba(62,28,23,0.95) 100%);
      border: 2px solid #f9e3c7;
      color: #ffe6b0;
      font-family: 'Figtree', system-ui, sans-serif;
    }
    .reality-card h2 {
      font-family: 'Changa One', 'Archivo Black', Impact, sans-serif;
      color: #fffbe8;
      margin: 0 0 8px;
      font-size: clamp(1.3rem, 3vw, 2rem);
      text-align: center;
    }
    .reality-host-line {
      font-size: clamp(1rem, 2.2vw, 1.3rem);
      margin: 10px 0 14px;
      text-align: center;
    }
    .reality-subtle {
      color: #ffd9a0;
      text-align: center;
      margin-bottom: 18px;
      font-style: italic;
    }
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 14px;
    }
    .stat-card {
      background: rgba(20, 10, 8, 0.5);
      border: 1px solid #cfae86;
      border-radius: 14px;
      padding: 14px;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.06);
    }
    .stat-title { font-weight: 600; margin-bottom: 6px; }
    .bar {
      height: 16px;
      background: #2b6b68;
      border-radius: 10px;
      position: relative;
      overflow: hidden;
    }
    .bar > span {
      position: absolute;
      left: 0; top: 0; bottom: 0;
      width: var(--pct);
      background: linear-gradient(90deg, #e7a52a, #ffd27a);
      box-shadow: 0 0 10px #e7a52a88;
    }
    .bar-label {
      margin-top: 6px;
      font-size: 0.95rem;
      color: #fffbe8;
    }
    .reality-continue {
      margin-top: 18px;
      display: flex;
      justify-content: center;
    }
    .reality-continue button {
      background: #2b6b68;
      color: #e7a52a;
      font-family: 'Changa One', 'Archivo Black', Impact, sans-serif;
      font-size: clamp(1rem, 2.4vw, 1.4rem);
      padding: 0.7rem 1.4rem;
      border-radius: 16px;
      border: none;
      box-shadow: 0 6px 0 rgba(80, 20, 10, 0.6);
      cursor: pointer;
    }
    .music-player {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 5;
      width: 70vw;
      max-width: 900px;
      height: 50vh;
      max-height: 500px;
      text-align: center;
      opacity: 0;
      animation: fadeIn 1s ease-in 1s forwards;
      background: linear-gradient(135deg, #ff6b35 0%, #d94a1a 50%, #c63a0a 100%);
      border-radius: 40px;
      padding: 50px;
      box-shadow: 0 15px 80px rgba(0, 0, 0, 0.6), inset 0 5px 15px rgba(255, 255, 255, 0.1);
    }
    .music-player::before {
      content: '';
      position: absolute;
      inset: -20px;
      background: linear-gradient(135deg, #ff9500 0%, #ff6b00 50%, #ff9500 100%);
      border-radius: 50px;
      z-index: -1;
      box-shadow: 0 0 40px rgba(255, 149, 0, 0.4);
    }
    .music-player::after {
      content: '';
      position: absolute;
      inset: -20px;
      border-radius: 50px;
      background-image:
        /* Top row bulbs */
        radial-gradient(circle at 5% 5%, #fff 10px, transparent 10px),
        radial-gradient(circle at 12% 5%, #fff 10px, transparent 10px),
        radial-gradient(circle at 19% 5%, #fff 10px, transparent 10px),
        radial-gradient(circle at 26% 5%, #fff 10px, transparent 10px),
        radial-gradient(circle at 33% 5%, #fff 10px, transparent 10px),
        radial-gradient(circle at 40% 5%, #fff 10px, transparent 10px),
        radial-gradient(circle at 47% 5%, #fff 10px, transparent 10px),
        radial-gradient(circle at 53% 5%, #fff 10px, transparent 10px),
        radial-gradient(circle at 60% 5%, #fff 10px, transparent 10px),
        radial-gradient(circle at 67% 5%, #fff 10px, transparent 10px),
        radial-gradient(circle at 74% 5%, #fff 10px, transparent 10px),
        radial-gradient(circle at 81% 5%, #fff 10px, transparent 10px),
        radial-gradient(circle at 88% 5%, #fff 10px, transparent 10px),
        radial-gradient(circle at 95% 5%, #fff 10px, transparent 10px),
        /* Left side bulbs */
        radial-gradient(circle at 5% 15%, #fff 10px, transparent 10px),
        radial-gradient(circle at 5% 25%, #fff 10px, transparent 10px),
        radial-gradient(circle at 5% 35%, #fff 10px, transparent 10px),
        radial-gradient(circle at 5% 45%, #fff 10px, transparent 10px),
        radial-gradient(circle at 5% 55%, #fff 10px, transparent 10px),
        radial-gradient(circle at 5% 65%, #fff 10px, transparent 10px),
        radial-gradient(circle at 5% 75%, #fff 10px, transparent 10px),
        radial-gradient(circle at 5% 85%, #fff 10px, transparent 10px),
        radial-gradient(circle at 5% 95%, #fff 10px, transparent 10px),
        /* Right side bulbs */
        radial-gradient(circle at 95% 15%, #fff 10px, transparent 10px),
        radial-gradient(circle at 95% 25%, #fff 10px, transparent 10px),
        radial-gradient(circle at 95% 35%, #fff 10px, transparent 10px),
        radial-gradient(circle at 95% 45%, #fff 10px, transparent 10px),
        radial-gradient(circle at 95% 55%, #fff 10px, transparent 10px),
        radial-gradient(circle at 95% 65%, #fff 10px, transparent 10px),
        radial-gradient(circle at 95% 75%, #fff 10px, transparent 10px),
        radial-gradient(circle at 95% 85%, #fff 10px, transparent 10px),
        radial-gradient(circle at 95% 95%, #fff 10px, transparent 10px),
        /* Bottom row bulbs */
        radial-gradient(circle at 12% 95%, #fff 10px, transparent 10px),
        radial-gradient(circle at 19% 95%, #fff 10px, transparent 10px),
        radial-gradient(circle at 26% 95%, #fff 10px, transparent 10px),
        radial-gradient(circle at 33% 95%, #fff 10px, transparent 10px),
        radial-gradient(circle at 40% 95%, #fff 10px, transparent 10px),
        radial-gradient(circle at 47% 95%, #fff 10px, transparent 10px),
        radial-gradient(circle at 53% 95%, #fff 10px, transparent 10px),
        radial-gradient(circle at 60% 95%, #fff 10px, transparent 10px),
        radial-gradient(circle at 67% 95%, #fff 10px, transparent 10px),
        radial-gradient(circle at 74% 95%, #fff 10px, transparent 10px),
        radial-gradient(circle at 81% 95%, #fff 10px, transparent 10px),
        radial-gradient(circle at 88% 95%, #fff 10px, transparent 10px);
      background-size: 100% 100%;
      background-repeat: no-repeat;
      z-index: -1;
      animation: bulbGlow 2s ease-in-out infinite;
    }
    @keyframes bulbGlow {
      0%, 100% { opacity: 0.9; }
      50% { opacity: 1; filter: drop-shadow(0 0 10px #fff); }
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
      to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    }
    .music-player-content {
      position: relative;
      z-index: 1;
      color: #fff;
      font-family: 'Changa One', 'Archivo Black', Impact, sans-serif;
    }
    /* Choice buttons styling matching provided image */
    .choice-buttons {
      display: flex;
      gap: 2rem;
      justify-content: center;
      margin-top: 1.2rem;
      pointer-events: auto;
    }
    .choice-btn {
      background: #2b6b68; /* teal */
      color: #e7a52a; /* golden text */
      font-family: 'Changa One', 'Archivo Black', Impact, sans-serif;
      font-size: clamp(1.2rem, 2.6vw, 2rem);
      padding: 0.9rem 2rem;
      border-radius: 18px;
      border: none;
      box-shadow: 0 6px 0 rgba(80, 20, 10, 0.6), 0 0 0 3px rgba(50, 20, 10, 0.45) inset;
      text-transform: uppercase;
      letter-spacing: 1px;
      cursor: pointer;
      transition: transform 0.15s ease, filter 0.15s ease;
    }
    .choice-btn:hover { transform: translateY(-2px); filter: brightness(1.05); }
    .choice-btn:active { transform: translateY(0); }
    @media (max-width: 800px) {
      .music-player {
        width: 85vw;
        height: 60vh;
        max-height: 450px;
        padding: 30px;
      }
      .music-player::before,
      .music-player::after {
        inset: -15px;
      }
      .host-overlay { 
        width: 40vw;
        left: 5%;
      }
      .text-container { 
        bottom: 8vh;
        left: 55%;
        transform: translateX(-50%);
      }
      .host-intro, .host-quote { 
        max-width: 45vw; 
        font-size: 0.9rem; 
        padding: 0.8rem 1.2rem; 
      }
      .click-indicator::after {
        bottom: 2vh;
        font-size: 0.85rem;
        padding: 0.6rem 1.5rem;
      }
    }
    @media (max-width: 400px) {
      .host-overlay { 
        position: relative;
        width: 60vw;
        left: 50%;
        transform: translateX(-50%);
        margin-top: 5vh;
      }
      .text-container { 
        position: relative;
        bottom: auto;
        left: 50%;
        transform: translateX(-50%);
        margin-top: 2vh;
        margin-bottom: 2vh;
      }
      body {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      .host-intro, .host-quote { 
        max-width: 85vw; 
        font-size: 0.85rem; 
        padding: 0.7rem 1rem; 
      }
      .click-indicator::after {
        bottom: 2vh;
        font-size: 0.75rem;
        padding: 0.5rem 1.2rem;
      }
    }
  </style>
</head>
<body>
  <img src="image-1764698329935.png" alt="Game show set background" class="host-bg" />
  <div class="host-overlay">
    <img src="the_host.png" alt="Del Disco, your host" class="host-img" />
  </div>
  <div class="text-container">
    <div class="host-intro">WELCOME TO THE SHOW!</div>
    <div class="host-quote">"Good evening, groovers. Welcome to <b>Can You Hear the AI?</b> The game show where your ears take center stage."</div>
  </div>
  <div class="screen-link" id="screenLink" aria-label="Continue to next section"></div>
  <div class="click-indicator" id="continueBtn" data-text="TAP ANYWHERE TO CONTINUE ›"></div>
  <div class="reality-overlay" id="realityOverlay">
    <div class="reality-card">
      <h2>ARTISTIC JOBS LOST TO AI</h2>
      <div class="reality-host-line">“As technology marches on, some stages grow quiet. Thousands of musicians, engineers, and session artists have seen their roles shrink.”</div>
      <div class="reality-subtle">He pauses, but keeps the tone light: “But rhythm? Creativity? That spark — it’s always worth fighting for.”</div>
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-title">Work lost to generative AI</div>
          <div class="bar" style="--pct:26%"><span></span></div>
          <div class="bar-label">Illustrators: 26%</div>
          <div class="bar" style="--pct:36%"><span></span></div>
          <div class="bar-label">Translators: 36%</div>
        </div>
        <div class="stat-card">
          <div class="stat-title">Income decreased due to generative AI</div>
          <div class="bar" style="--pct:37%"><span></span></div>
          <div class="bar-label">Illustrators: 37%</div>
          <div class="bar" style="--pct:43%"><span></span></div>
          <div class="bar-label">Translators: 43%</div>
        </div>
        <div class="stat-card">
          <div class="stat-title">Expect negative future income impact</div>
          <div class="bar" style="--pct:65%"><span></span></div>
          <div class="bar-label">Fiction writers: 65%</div>
          <div class="bar" style="--pct:57%"><span></span></div>
          <div class="bar-label">Non-fiction writers: 57%</div>
          <div class="bar" style="--pct:77%"><span></span></div>
          <div class="bar-label">Translators: 77%</div>
          <div class="bar" style="--pct:78%"><span></span></div>
          <div class="bar-label">Illustrators: 78%</div>
        </div>
        <div class="stat-card">
          <div class="stat-title">Top concerns</div>
          <div class="bar" style="--pct:86%"><span></span></div>
          <div class="bar-label">Style/voice/likeness mimicked: 86%</div>
          <div class="bar" style="--pct:86%"><span></span></div>
          <div class="bar-label">AI devalues human-made work: 86%</div>
        </div>
      </div>
      <div class="reality-continue"><button id="realityContinue">CONTINUE ›</button></div>
    </div>
  </div>
  <audio id="host-audio" src="assets/audio/intro.mp3" autoplay preload="auto"></audio>
  
  <script>
    let currentScreen = 1;
    let currentTrackIndex = 0;
    let completedTracksCount = 0; // how many tracks have been completed this session
    let waitingForContinue = false; // Only advance when user taps the continue button
    let showingRealityCheck = false;
    let currentReflectionQuestion = 0;
    const reflectionQuestions = [
      {
        question: 'After hearing those tracks, how do you feel?',
        options: ['Pretty confident', 'A little uncertain', 'Surprised the machines sounded that good']
      },
      {
        question: "Do you think music's losing its human spark?",
        options: ['Yes', 'No', 'Hard to say']
      },
      {
        question: 'Should humans keep making music?',
        options: ['Absolutely', 'Of course', 'You bet']
      }
    ];
    const tracks = [
      {
        audio: 'britney-spears-criminalmp3_6olTcWGN.mp3',
        correctAnswer: 'AI',
        feedbackRight: 'You got it! Nice ear.',
        feedbackWrong: 'No sweat, the machines fooled plenty of folks this week.'
      },
      {
        audio: 'animals-maroon-5_SJqDof78.mp3',
        correctAnswer: 'AI',
        feedbackRight: 'Spot on — that one was AI-generated.',
        feedbackWrong: 'Tricky track! Lots of folks guessed Human there.'
      },
      {
        audio: 'jazz-in-10-seconds_c9gLW94C.mp3',
        correctAnswer: 'AI',
        feedbackRight: 'You nailed it — AI improvised that one!',
        feedbackWrong: 'Tricky jazz! That was AI, believe it or not.'
      },
      {
        audio: 'jazz-background-music-349165_C5BIX0LJ.mp3',
        correctAnswer: 'Human',
        feedbackRight: 'Perfect! That human touch came through.',
        feedbackWrong: 'So close! That one was crafted by human hands.'
      }
    ];
    let trackAudio = null;
    const screenLink = document.getElementById('screenLink');
    const continueBtn = document.getElementById('continueBtn');
    const hostIntro = document.querySelector('.host-intro');
    const hostQuote = document.querySelector('.host-quote');
    const hostOverlay = document.querySelector('.host-overlay');
    const textContainer = document.querySelector('.text-container');
    const hostBg = document.querySelector('.host-bg');
    // Preload host face images to ensure instant swaps on feedback
    ['wrong_face_host.png', 'right_face_host.png', 'the_host.png'].forEach(src => { const img = new Image(); img.src = src; });
    
    screenLink.addEventListener('click', function() {
      // Support tap-anywhere-to-continue while waiting
      if (waitingForContinue) {
        waitingForContinue = false;
        proceedWithScreen();
        return;
      }
      proceedWithScreen();
    });
    
    continueBtn.addEventListener('click', function() {
      // Full-screen tap-anywhere: always proceed. Clear waiting flag if set.
      if (waitingForContinue) waitingForContinue = false;
      proceedWithScreen();
    });

    function proceedWithScreen() {
      if (currentScreen === 1) {
        // Change to rules screen
        hostIntro.innerHTML = 'The Challenge Is Introduced';
        hostQuote.innerHTML = '"You\'ll hear a series of mysterious musical snippets. Some were composed by talented human creators…and some were whipped up by our very own artificial audio AI! Your mission: decide <b>HUMAN or AI?</b>"';
        currentScreen = 2;
      } else if (currentScreen === 2) {
        // Change to "Now let's begin" screen
        hostIntro.innerHTML = 'Now let\'s begin';
        hostQuote.innerHTML = '';
        currentScreen = 3;
      } else if (currentScreen === 3) {
        // Transition to music player
        hostOverlay.classList.add('fade-out');
        textContainer.classList.add('fade-out');
        continueBtn.classList.add('fade-out');
        screenLink.style.display = 'none';
        
        setTimeout(() => {
          hostBg.classList.add('dimmed');
          
          // Create music player for current track
          const musicPlayer = document.createElement('div');
          musicPlayer.className = 'music-player';
          const track = tracks[currentTrackIndex] || tracks[0];
          musicPlayer.innerHTML = `<div class="music-player-content"><h2>Music Player</h2><p>Playing track ${currentTrackIndex + 1}...</p></div>`;
          document.body.appendChild(musicPlayer);
          // Play actual audio and wait for it to finish
          try {
            if (trackAudio) { trackAudio.pause(); trackAudio = null; }
            trackAudio = new Audio(track.audio);
            trackAudio.play().catch(() => {/* ignore autoplay errors */});
          } catch (e) { /* no-op */ }
          
                  // After music plays, show the question
                  const proceedToQuestion = () => {
                    try { if (trackAudio) { trackAudio.pause(); } } catch (e) {}
                    musicPlayer.classList.add('fade-out');
                    setTimeout(() => {
                      musicPlayer.remove();
              
                      // Bring back host and show question
                      hostBg.classList.remove('dimmed');
                      hostOverlay.style.opacity = '1';
                      hostOverlay.classList.remove('fade-out');
                      textContainer.style.opacity = '1';
                      textContainer.classList.remove('fade-out');
                      continueBtn.style.display = 'none';
              
                      hostIntro.innerHTML = 'Now tell me… was that track crafted by human hands?\nOr did our electronic friends behind the curtain cook that one up?';
                      hostQuote.innerHTML = '';
                      // Add AI / Human buttons styled to match provided image
                      const buttonContainer = document.createElement('div');
                      buttonContainer.className = 'choice-buttons';
                      buttonContainer.innerHTML = `
                        <button id="btnAI" class="choice-btn">AI</button>
                        <button id="btnHuman" class="choice-btn">Human</button>
                      `;
                      textContainer.appendChild(buttonContainer);

                      const btnAI = document.getElementById('btnAI');
                      const btnHuman = document.getElementById('btnHuman');
                      const correctAnswer = track.correctAnswer;

                      function handleAnswer(answer) {
                        // Disable further interaction on buttons immediately
                        const btns = textContainer.querySelectorAll('.choice-btn');
                        btns.forEach(b => { b.disabled = true; b.style.pointerEvents = 'none'; b.style.opacity = '0.9'; });
                        
                        const hostImg = document.querySelector('.host-img');
                        
                        // Update image and text in the same frame to keep them in sync
                        const isWrong = (answer !== correctAnswer);
                        requestAnimationFrame(() => {
                          if (hostImg) {
                            hostImg.src = isWrong ? 'wrong_face_host.png' : 'right_face_host.png';
                          }
                          hostIntro.innerHTML = isWrong
                            ? (track.feedbackWrong || 'No sweat, the machines fooled plenty of folks this week.')
                            : (track.feedbackRight || 'You got it! Nice ear.');
                          hostQuote.innerHTML = '';
                        });

                        // Advance to next track after a readable pause
                        // Hide/disable continue while feedback is shown
                        continueBtn.style.display = 'none';
                        setTimeout(() => {
                          // Mark track completed and advance index
                          completedTracksCount += 1;
                          currentTrackIndex = (currentTrackIndex + 1) % tracks.length;
                          // Reset host face if it was changed
                          const hostImg = document.querySelector('.host-img');
                          if (hostImg) hostImg.src = 'the_host.png';
                          // Remove button container to prevent duplicates
                          const oldButtons = textContainer.querySelector('.choice-buttons');
                          if (oldButtons) oldButtons.remove();
                          // After exactly two tracks have completed, show the reality check interlude once
                          if (completedTracksCount === 2 && !showingRealityCheck) {
                            showRealityCheck();
                          } else if (completedTracksCount === 4) {
                            // After all four tracks, start the reflection segment
                            showReflectionSegment();
                          } else {
                            // Re-show continue to start next round as full-screen tap target
                            continueBtn.style.display = 'block';
                            continueBtn.setAttribute('data-text', 'TAP ANYWHERE TO CONTINUE ›');
                            continueBtn.textContent = '';
                            continueBtn.classList.remove('fade-out');
                            continueBtn.style.opacity = '1';
                            // Disable screenLink; continueBtn handles full-screen taps now
                            screenLink.style.display = 'none';
                            screenLink.style.pointerEvents = 'none';
                            currentScreen = 3; // stay in music/question loop
                            hostIntro.innerHTML = 'Ready for the next track?';
                            hostQuote.innerHTML = '';
                            // Require deliberate tap-anywhere to proceed
                            waitingForContinue = true;
                            // Full-screen continueBtn will capture taps
                          }
                        }, 5000);
                      }

                      const invokeAI = (e) => { e.preventDefault(); e.stopPropagation(); handleAnswer('AI'); };
                      const invokeHuman = (e) => { e.preventDefault(); e.stopPropagation(); handleAnswer('Human'); };
                      // Use pointerdown for immediate response (touch + mouse)
                      btnAI.addEventListener('pointerdown', invokeAI, { once: true });
                      btnHuman.addEventListener('pointerdown', invokeHuman, { once: true });
                      // Fallback for environments without pointer events
                      btnAI.addEventListener('mousedown', invokeAI, { once: true });
                      btnHuman.addEventListener('mousedown', invokeHuman, { once: true });
                      btnAI.addEventListener('touchstart', invokeAI, { once: true });
                      btnHuman.addEventListener('touchstart', invokeHuman, { once: true });
                    }, 1000);
                  };

                  // Prefer audio 'ended' event; also handle load error; fallback timeout if no audio
                  if (trackAudio) {
                    trackAudio.addEventListener('ended', proceedToQuestion, { once: true });
                    trackAudio.addEventListener('error', () => {
                      setTimeout(proceedToQuestion, 800);
                    }, { once: true });
                  } else {
                    setTimeout(proceedToQuestion, 5000);
                  }
        }, 500);
      }
    }

    // Reflection segment: shows quick-fire multiple-choice questions after all tracks
    function showReflectionSegment() {
      // Hide answer feedback UI
      continueBtn.style.display = 'none';
      screenLink.style.pointerEvents = 'none';
      
      // Present the first reflection question
      currentReflectionQuestion = 0;
      showReflectionQuestion();
    }

    function showReflectionQuestion() {
      if (currentReflectionQuestion >= reflectionQuestions.length) {
        // All questions answered, end the game
        hostIntro.innerHTML = 'Thanks for playing!';
        hostQuote.innerHTML = '"Remember: creativity is always worth fighting for."';
        continueBtn.style.display = 'none';
        // Brief pause, then return to home
        try { screenLink.style.pointerEvents = 'none'; } catch (e) {}
        setTimeout(() => {
          window.location.href = 'index.html';
        }, 4000);
        return;
      }

      const q = reflectionQuestions[currentReflectionQuestion];
      hostIntro.innerHTML = q.question;
      hostQuote.innerHTML = '';
      
      // Remove any old choice buttons
      const oldButtons = textContainer.querySelector('.choice-buttons');
      if (oldButtons) oldButtons.remove();

      // Create choice buttons for this question
      const buttonContainer = document.createElement('div');
      buttonContainer.className = 'choice-buttons';
      buttonContainer.style.flexDirection = 'column';
      buttonContainer.style.gap = '1rem';
      q.options.forEach((opt, idx) => {
        const btn = document.createElement('button');
        btn.className = 'choice-btn';
        btn.textContent = String.fromCharCode(65 + idx) + ') ' + opt;
        btn.style.width = '100%';
        btn.style.maxWidth = '400px';
        const handleClick = (e) => {
          e.preventDefault();
          e.stopPropagation();
          // Disable all buttons after selection
          buttonContainer.querySelectorAll('.choice-btn').forEach(b => {
            b.disabled = true;
            b.style.pointerEvents = 'none';
            b.style.opacity = '0.6';
          });
          // Advance to next question after a short delay
          setTimeout(() => {
            currentReflectionQuestion++;
            showReflectionQuestion();
          }, 800);
        };
        btn.addEventListener('pointerdown', handleClick, { once: true });
        btn.addEventListener('mousedown', handleClick, { once: true });
        btn.addEventListener('touchstart', handleClick, { once: true });
        buttonContainer.appendChild(btn);
      });
      textContainer.appendChild(buttonContainer);
    }

    // Reality check interlude: dims background and shows host lines + stats
    function showRealityCheck() {
      showingRealityCheck = true;
      // Dim everything and show overlay
      document.querySelector('.host-bg').classList.add('dimmed');
      const overlay = document.getElementById('realityOverlay');
      overlay.style.display = 'flex';
      // Keep only the overlay interactive
      screenLink.style.pointerEvents = 'none';
      continueBtn.style.display = 'none';
      // Swap host to neutral face for the monologue
      const hostImg = document.querySelector('.host-img');
      if (hostImg) hostImg.src = 'the_host.png';
      // Bring host to the foreground so it looks like he's speaking
      hostOverlay.classList.add('host-on-top');
      // Update the caption area lightly if desired
      hostIntro.innerHTML = 'A quick reality check…';
      hostQuote.innerHTML = '';

      const realityContinue = document.getElementById('realityContinue');
      realityContinue.onclick = () => {
        // Hide overlay and undim
        overlay.style.display = 'none';
        document.querySelector('.host-bg').classList.remove('dimmed');
        showingRealityCheck = false;
        hostOverlay.classList.remove('host-on-top');
        // Return to loop: show Next Track
        continueBtn.style.display = 'block';
        continueBtn.setAttribute('data-text', 'TAP ANYWHERE TO CONTINUE ›');
        continueBtn.textContent = '';
        continueBtn.classList.remove('fade-out');
        continueBtn.style.opacity = '1';
        // Use the full-screen continue button; keep screenLink inactive
        screenLink.style.display = 'none';
        screenLink.style.pointerEvents = 'none';
        waitingForContinue = true;
        currentScreen = 3;
      };
    }
  </script>
</body>
</html>
